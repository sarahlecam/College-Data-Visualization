<!DOCTYPE html>
<html>
<head>
	<title>Project 2 - INFO/CS 3300</title>
	<link href="https://fonts.googleapis.com/css?family=Raleway:400,700italic" rel="stylesheet" type="text/css">
	<link href="style.css" rel="stylesheet" type="text/css">
	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
	<script src="http://d3js.org/topojson.v1.min.js"></script>
	<script src="us.js"></script>
</head>
<body>
	<nav id="nav">
		Project 2
	</nav>

	<div id="info">
		<h3 id="college"></h3>
	</div>

	<div id="map">
		<script>
			// set up map
			var mapWidth = 900, mapHeight = 500;

			var projection = d3.geo.albersUsa()
			    .scale(1000)
			    .translate([mapWidth / 2, mapHeight / 2]);

			var path = d3.geo.path()
			    .projection(projection);

			var svg = d3.select("body").append("svg")
			    .attr("width", mapWidth)
			    .attr("height", mapHeight)
			    .style("background-color", "#d3d3d3")

			d3.json("us.json", function(error, us) {
			  if (error) throw error;

			  svg.insert("path", ".graticule")
			      .datum(topojson.feature(us, us.objects.land))
			      .attr("class", "land")
			      .attr("d", path);

			  svg.insert("path", ".graticule")
			      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
			      .attr("class", "state-boundary")
			      .attr("d", path);
			});

			svg.append("text")
				.text("Click on a college to learn more about it")
				.attr("id", "location")
				.attr("x", mapWidth/2)
				.attr("y", 15)
				.attr("alignment-baseline", "central")
				.attr("text-anchor", "middle");

			d3.select(self.frameElement).style("height", mapHeight + "px");

			// testing some random points
			// needed to set timeout so that the points don't load behind the map...
			// not sure why I need to do this

			function addCoords() {
				var cities = 
				[
					{
						city: "Ithaca, NY",
						coord: projection([-76.5,42.4433])
					},
					{
						city: "New York City, NY",
						coord: projection([-74.0059, 40.7128])
					}
				];

				circles = svg.selectAll(".point").data(cities);

				circles.enter().append("circle")
				.attr("class", "point")
				.attr("cx", function(d) { return d.coord[0]; })
				.attr("cy", function(d) { return d.coord[1]; })
				.attr("r", 5)
				.style("fill", "#ff6378")
				.on("mouseover", function (d) {
					d3.select("#location").text(d.city);
				})
				.on("mouseout", function (d) {
					d3.select("#location").text("Click on a college to learn more about it");
				})
				.on("click", function (d) {
					d3.select("#college").text(d.city)
					.style("opacity", 0)
					.transition()
					.duration(1000)
					.style("opacity", 1);
				});

			};
			setTimeout(addCoords, 1000);
		</script>
	</div>

</body>
</html>